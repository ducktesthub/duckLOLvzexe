local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local PlaceId = game.PlaceId

-- ğŸ“¢ Thay webhook Discord vÃ o Ä‘Ã¢y
local webhookURL = "https://discord.com/api/webhooks/1337674068643549214/7VEKBq_Q5Bpw2iBTifqaOcAS24ZCZ-jmGLO9ugLZYi_I9fhKKhjGRVaUFyJVY_6Q5Kxz"

-- ğŸ² Chá»‰ nháº·t trÃ¡i tá»« LEGEND trá»Ÿ lÃªn
local fruitRarity = {
    ["East Dragon"] = 7, ["West Dragon"] = 7, 
    ["Kitsune"] = 6, ["Yeti"] = 5, ["Gas"] = 4.5,  
    ["Leopard"] = 4, ["Dough"] = 4, ["Shadow"] = 4,
    ["Venom"] = 4, ["Control"] = 4, ["Spirit"] = 4,
    ["Buddha"] = 3, ["Blizzard"] = 3, ["Quake"] = 3,
    ["Rumble"] = 3
}

-- ğŸ” TÃ¬m trÃ¡i hiáº¿m nháº¥t gáº§n nháº¥t
local function findBestFruit()
    local bestFruit, bestRarity, minDistance = nil, 0, math.huge
    for _, obj in pairs(workspace:GetChildren()) do
        if obj:IsA("Tool") and fruitRarity[obj.Name] then
            local distance = (obj.Position - Character.HumanoidRootPart.Position).Magnitude
            if fruitRarity[obj.Name] > bestRarity or (fruitRarity[obj.Name] == bestRarity and distance < minDistance) then
                bestRarity, minDistance, bestFruit = fruitRarity[obj.Name], distance, obj
            end
        end
    end
    return bestFruit
end

-- âš¡ Dá»‹ch chuyá»ƒn Ä‘áº¿n trÃ¡i Ã¡c quá»·
local function teleportToFruit(fruit)
    if fruit then
        Character.HumanoidRootPart.CFrame = fruit.CFrame
        wait(0.5)
    end
end

-- ğŸ“¢ Gá»­i tin nháº¯n vá» Webhook Discord
local function sendWebhookMessage(fruitName)
    local data = { ["content"] = "ğŸ“¢ **ÄÃ£ tÃ¬m & lÆ°u trá»¯ trÃ¡i hiáº¿m!** ğŸ\n**TrÃ¡i:** " .. fruitName .. "\nğŸ”— Server ID: " .. game.JobId }
    local success = pcall(function()
        HttpService:PostAsync(webhookURL, HttpService:JSONEncode(data), Enum.HttpContentType.ApplicationJson, false)
    end)
    if success then print("âœ… Webhook gá»­i thÃ nh cÃ´ng!") else print("âŒ Webhook lá»—i!") end
end

-- ğŸ“¦ LÆ°u trá»¯ trÃ¡i Ã¡c quá»·
local function storeFruit(fruitName)
    ReplicatedStorage.Remotes.CommF_:InvokeServer("StoreFruit")
    print("âœ… ÄÃ£ lÆ°u trá»¯ trÃ¡i: " .. fruitName)
    sendWebhookMessage(fruitName)
end

-- ğŸ”„ Äá»•i server náº¿u khÃ´ng cÃ³ trÃ¡i
local function hopServer()
    local servers = {}
    local url = "https://games.roblox.com/v1/games/" .. PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"
    local success, response = pcall(function() return HttpService:GetAsync(url) end)

    if success then
        local data = HttpService:JSONDecode(response)
        for _, server in pairs(data.data or {}) do
            if server.playing < server.maxPlayers and server.id ~= game.JobId then
                table.insert(servers, server.id)
            end
        end
    end

    if #servers > 0 then
        print("ğŸ”„ Äang chuyá»ƒn server: " .. servers[1])
        TeleportService:TeleportToPlaceInstance(PlaceId, servers[1], LocalPlayer)
    else
        print("âŒ KhÃ´ng tÃ¬m tháº¥y server má»›i!")
    end
end

-- ğŸš€ Cháº¡y script
while true do
    local fruit = findBestFruit()
    if fruit then
        print("ğŸ TÃ¬m tháº¥y trÃ¡i hiáº¿m: " .. fruit.Name)
        teleportToFruit(fruit)
        wait(1)
        storeFruit(fruit.Name)
    else
        print("âŒ KhÃ´ng cÃ³ trÃ¡i Legend -> Äá»•i server")
        hopServer()
    end
    wait(5)
end
